/*==============================================================================
Feel free to add your own header, but please keep the following:
 ___  _   _    _
/   || | | |  | |
\__  | | | |  | |  __
/    |/  |/_) |/  /  \_/\/
\___/|__/| \_/|__/\__/  /\_/
              |\
              |/
Concrete v2.0.3
https://github.com/Elkfox/Concrete
Copyright (c) 2017 Elkfox Co Pty Ltd
https://elkfox.com
MIT License
==============================================================================*/

window.concrete = window.concrete || {};

// perhaps turn into an assign in function?
concrete.strings = {
  soldOut: "{{ 'product.sold_out' | t }}",
  addToCart: "{{ 'product.add_to_cart' | t }}",
  unavailable: "{{ 'product.unavailable' | t }}"
};

concrete.urlParams = {};

/*================ Concrete ================*/
// =require concrete/cache.js
// =require concrete/utils.js
// =require concrete/a11y.js
// =require concrete/currency.js
// =require concrete/sections.js
// =require concrete/images.js
// =require concrete/collection.js
// =require concrete/variants.js
// =require concrete/product.js
// =require concrete/empty-section.js


// Initialize on document ready
$(document).ready(function() {
  // Register sections js
  var sections = new concrete.Sections();
  sections.register('product', concrete.Product);
  sections.register('collection', concrete.Collection);
});

// No More jQuery
document.addEventListener("DOMContentLoaded", function() {
  // Search function
  var headerSearch = document.querySelectorAll('.js-search');
  for (var i = 0; i < headerSearch.length; i++) {
    headerSearch[i].addEventListener('click', function(e) {

      var target = e.target;
      var mbTarget = document.querySelector('.mobile-search');
      var mbTargetImg = document.querySelector('.mobile-search img');
      var dkTarget = document.querySelector('.desktop-search');
      var dkTargetImg = document.querySelector('.desktop-search img');
      var dur = { duration: 300 };
      function searchOpenCheck() {
        var form = document.querySelector('.theme-header form');
        var isOpen = form.classList.contains('js-open');
        if (isOpen === false) {
          form.classList.add('js-open');
          form.velocity({ height: '110px' }, dur);
        } else {
          form.classList.remove('js-open');
          form.velocity({ height: 0 }, dur);
        }
      }

      if (target == mbTarget || target == mbTargetImg) {
        searchOpenCheck();
      } else if (target == dkTarget || dkTargetImg) {
        searchOpenCheck();
      }
    });
  }

  // Mobile Menu
  var hamburger = document.querySelector('.js-mobile-menu');
  var mobileMenu = document.querySelector('.mobile-menu');
  hamburger.addEventListener('click', function(e) {
    var target = e.target;
    if (target.tagName === 'LABEL') {
      var isOpen = mobileMenu.classList.contains('js-open');
      var dur = { duration: 300 };
      if (isOpen === false) {
        mobileMenu.classList.add('js-open');
        mobileMenu.velocity({ width: '80%' }, dur);
      } else {
        mobileMenu.classList.remove('js-open');
        mobileMenu.velocity({ width: 0 }, dur);
      }
    }
  });
});
